(function(){apPlaylistManager=function(){function i(){if(!(3>d)){var b=d,a=[],f=[],g=0,e=0;for(g;g<b;g++)a[g]=g;e=0;for(e;e<b;e++)g=Math.round(Math.random()*(a.length-1)),f[e]=a[g],a.splice(g,1);c=f}}var o=this,l,f,d,j=!1,a=-1,m,h,e=!1,n=!1,c=[],k=!1;this.init=function(a,c){l=a;f=c};this.setCounter=function(b,e){a=e?a+parseInt(b,10):parseInt(b,10);j=!1;if(l)if(f)if(a>d-1){a=c[d-1];i();if(c[0]==a){var h=c.splice(0,1);c.push(h)}a=0}else 0>a&&(a=c[0],i(),c[d-1]==a&&(h=c.splice(d-1,1),c.unshift(h)),a= d-1);else a>d-1?a=0:0>a&&(a=d-1);else a>d-1?(a=d-1,j=!0):0>a&&(a=0,j=!0);n&&console.log("counter = "+o.getCounter())};this.getCounter=function(){return f?k?a:c[a]:a};this.advanceHandler=function(a,c){k=!1;e?this.handleRandomPaused(a):this.setCounter(a,c)};this.processPlaylistRequest=function(b){k=!1;f&&(k=!0,m=b,e||(h=a,e=!0));this.setCounter(b,!1)};this.handleRandomPaused=function(b){e=!1;h+b>d-1?a=d-1:0>h+b?a=0:this.setCounter(h+b,!1)};this.getLastInOrder=function(){return j};this.getRandomPaused= function(){return e};this.setPlaylistItems=function(b){a=-1;d=b;f&&i()};this.reSetCounter=function(){a=-1};this.setRandom=function(b){(f=b)&&i();if(f){var b=0,d=c.length;for(b;b<d;b++)if(c[b]==a){if(0==b)break;b=c.splice(b,1);c.unshift(b);break}a=0}else e?(a=m,e=!1):a=c[a]};this.setLooping=function(a){l=a};this.setTraceCounter=function(a){n=a}}})(jQuery);